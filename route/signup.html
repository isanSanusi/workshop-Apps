<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>Signup - Prototype</title>
      <link rel="stylesheet" href="../style/flash.css" />
      <link rel="stylesheet" href="../style/loginStyle.css" />
   </head>
   <body>
      <div class="login-container">
         <div class="login-card">
            <h2>Create New User</h2>
            <form id="signupForm">
               <div class="input-group">
                  <input
                     type="text"
                     id="username"
                     required
                     placeholder="Name new user"
                  />
               </div>
               <div class="input-group">
                  <input
                     type="password"
                     id="password"
                     required
                     placeholder="Password new user"
                  />
               </div>
               <div class="roles">
                  <label for="role">Choose Role</label>
                  <select id="role" required>
                     <option value="admin">admin</option>
                     <option value="lapangan">lapangan</option>
                  </select>
               </div>
               <button type="submit" class="login-btn">Daftar</button>
               <p class="back-link">
                  <a href="./admin.html">⬅️ Kembali ke Admin</a>
               </p>
            </form>
         </div>
      </div>

      <script src="../js/flash.js"></script>
      <script>
         document
            .getElementById("signupForm")
            .addEventListener("submit", function (e) {
               e.preventDefault();

               const username = document
                  .getElementById("username")
                  .value.trim();
               const password = document
                  .getElementById("password")
                  .value.trim();
               const role = document.getElementById("role").value;

               if (!username || !password) {
                  flashAlert("error", "Username and Password empty");
                  return;
               }

               // Ambil data user yang sudah ada
               let users = JSON.parse(localStorage.getItem("users")) || [];

               // Cek apakah username sudah dipakai
               if (users.some((u) => u.username === username)) {
                  flashAlert("error", "Username is exist");
                  return;
               }

               // Simpan user baru
               users.push({
                  username,
                  password,
                  role,
               });

               localStorage.setItem("users", JSON.stringify(users));
               flashAlert("success", "Horay..New user was added");
               window.location.href = "./admin.html";
            });
      </script>
   </body>
</html>
